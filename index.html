<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gerador de Bilhetes</title>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f2f2f2;
    }

    h1 {
        text-align: center;
    }

    .form-box {
        margin: 20px auto;
        text-align: center;
    }

    input {
        padding: 10px;
        font-size: 16px;
    }

    button {
        padding: 10px 18px;
        font-size: 16px;
        cursor: pointer;
    }

    /* Área dos bilhetes */
    .tickets-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        padding: 20px;
        margin-top: 30px;
        page-break-inside: avoid;
    }

    .ticket {
        width: 100%;
        aspect-ratio: 9/16; /* vertical */
        background: url("ticket.png"); /* altere para o nome real */
        background-size: cover;
        background-position: center;
        position: relative;
        border: 1px solid #000;
    }

    .ticket-number {
        position: absolute;
        bottom: 10px;
        right: 12px;
        font-size: 28px;
        font-weight: bold;
        color: black;
    }

    @media print {
        button, input { display: none; }
    }
</style>
</head>
<body>

<h1>Gerador de Bilhetes</h1>

<div class="form-box">
    <input type="text" id="seller" placeholder="Nome do vendedor" required>
    <button onclick="gerarBilhetes()">Gerar 100 bilhetes</button>
</div>

<div id="tickets" class="tickets-container"></div>

<script>
// ======= CONFIGURAÇÃO DO APP SCRIPT =======
const API_URL = "https://script.google.com/macros/s/AKfycbwYw_vp0WKfHzjh64F74FCCZ2ZQPWFkLq6RLLghtqMvATNQGwZYt3KT2wr0Yg5-idqAbQ/exec";

// ======= FUNÇÃO PRINCIPAL =======
async function gerarBilhetes() {
    const seller = document.getElementById("seller").value.trim();
    if (!seller) {
        alert("Digite o nome do vendedor.");
        return;
    }

    const response = await fetch(API_URL + "?seller=" + encodeURIComponent(seller));
    const data = await response.json();

    if (!data.success) {
        alert("Erro no Apps Script.");
        return;
    }

    const numbers = data.generated; // array retornado pelo script
    const container = document.getElementById("tickets");
    container.innerHTML = "";

    numbers.forEach(num => {
        const div = document.createElement("div");
        div.className = "ticket";

        const span = document.createElement("div");
        span.className = "ticket-number";
        span.innerText = num;

        div.appendChild(span);
        container.appendChild(div);
    });

    window.scrollTo(0, document.body.scrollHeight);
}
</script>

</body>
</html>
